<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>永續合約止損計算器</title>
  <script>
    function updateStopLossDistance() {
      const entry = parseFloat(document.getElementById("entryPrice").value);
      const stop = parseFloat(document.getElementById("stopPrice").value);
      if (!isNaN(entry) && !isNaN(stop) && entry !== 0) {
        const distance = Math.abs((entry - stop) / entry * 100).toFixed(2);
        document.getElementById("stopDistance").value = distance;
      }
    }

    function calculateIsolated() {
      const cost = parseFloat(document.getElementById("cost").value);
      const entry = parseFloat(document.getElementById("entryPrice").value);
      const stop = parseFloat(document.getElementById("stopPrice").value);
      const direction = document.querySelector('input[name="direction"]:checked').value;

      if (isNaN(cost) || isNaN(entry) || isNaN(stop)) return;

      let lossRate;
      if (direction === "long") {
        lossRate = (entry - stop) / entry;
      } else {
        lossRate = (stop - entry) / entry;
      }

      const leverage = Math.floor(1 / Math.abs(lossRate));
      const lossAmount = cost;

      document.getElementById("isolatedResult").innerHTML =
        `建議槓桿倍數：${leverage} 倍<br>` +
        `潛在虧損：$${lossAmount.toFixed(2)} (${(Math.abs(lossRate * leverage) * 100).toFixed(2)}%)<br>` +
        `倉位價值：約 $${(cost * leverage).toFixed(2)} 美金`;
    }

    function calculateCross() {
      const capital = parseFloat(document.getElementById("capital").value);
      const stopPercent = parseFloat(document.getElementById("stopPercent").value);
      const entry = parseFloat(document.getElementById("entryPriceCross").value);
      const stop = parseFloat(document.getElementById("stopPriceCross").value);
      const direction = document.querySelector('input[name="directionCross"]:checked').value;

      if (isNaN(capital) || isNaN(stopPercent) || isNaN(entry) || isNaN(stop)) return;

      let lossRate;
      if (direction === "long") {
        lossRate = (entry - stop) / entry;
      } else {
        lossRate = (stop - entry) / entry;
      }

      const leverage = Math.floor((stopPercent / 100) / Math.abs(lossRate));
      const positionValue = capital * leverage;

      document.getElementById("crossResult").innerHTML =
        `建議槓桿倍數：${leverage} 倍<br>` +
        `潛在虧損：$${(capital).toFixed(2)} (${stopPercent.toFixed(2)}%)<br>` +
        `倉位價值：約 $${positionValue.toFixed(2)} 美金`;
    }
  </script>
</head>
<body>
  <h2>永續合約止損計算器</h2>
  <h3>模式選擇</h3>
  <div style="border: 1px solid black; padding: 10px; margin-bottom: 20px">
    <h3>逐倉模式</h3>
    投入成本(USD)：<input type="number" id="cost" /><br />
    幣種：
    <select>
      <option>BTC</option><option>ETH</option><option>SOL</option><option>DOGE</option>
      <option>BNB</option><option>XRP</option><option>ADA</option><option>SUI</option>
      <option>其他</option>
    </select><br>
    方向：
    <input type="radio" name="direction" value="long" checked /> 多
    <input type="radio" name="direction" value="short" /> 空<br />
    進場價：<input type="number" id="entryPrice" oninput="updateStopLossDistance()" /><br />
    止損價：<input type="number" id="stopPrice" oninput="updateStopLossDistance()" /><br />
    止損距離(%)：<input type="text" id="stopDistance" readonly /><br />
    <button onclick="calculateIsolated()">計算</button>
    <div id="isolatedResult"></div>
  </div>

  <div style="border: 1px solid black; padding: 10px;">
    <h3>全倉模式</h3>
    本金(USD)：<input type="number" id="capital" /><br />
    方向：
    <input type="radio" name="directionCross" value="long" checked /> 多
    <input type="radio" name="directionCross" value="short" /> 空<br />
    止損佔比(%)：<input type="number" id="stopPercent" /><br />
    進場價：<input type="number" id="entryPriceCross" /><br />
    止損價：<input type="number" id="stopPriceCross" /><br />
    <button onclick="calculateCross()">計算</button>
    <div id="crossResult"></div>
  </div>
</body>
</html>






  
